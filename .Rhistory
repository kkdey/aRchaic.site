grid.newpage()
do.call(StructureGGplot, append(list(omega= omega,
annotation = annotation,
palette = topic_cols),
structure.control))
ggplot2::ggsave(paste0(output_dir, "structure.png"), width = structure_width,
height = structure_height)
plot.new()
damageLogo_five(topic_clus$theta, save_plot=TRUE, output_dir = output_dir)
graphics.off()
K=4
structure.control.default <- list(yaxis_label = "aRchaic pops",
order_sample = FALSE,
figure_title = paste0("  StructurePlot: K=", K,""),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 10,
axis_label_face = "bold"),
legend_title_size = 10,
legend_key_size = 0.7,
legend_text_size = 8)
structure.control <- modifyList(structure.control, structure.control.default)
plot.new()
grid.newpage()
do.call(StructureGGplot, append(list(omega= omega,
annotation = annotation,
palette = topic_cols),
structure.control))
ggplot2::ggsave(paste0(output_dir, "structure.png"), width = structure_width,
height = structure_height)
plot.new()
damageLogo_five(topic_clus$theta, save_plot=TRUE, output_dir = output_dir)
graphics.off()
plot.new()
grid.newpage()
do.call(StructureGGplot, append(list(omega= omega,
annotation = annotation,
palette = topic_cols),
structure.control))
ggplot2::ggsave(paste0(output_dir, "structure.png"), width = structure_width,
height = structure_height)
plot.new()
damageLogo_five(topic_clus$theta, save_plot=TRUE,
inflation_factor = c(2,1,2), output_dir = output_dir)
graphics.off()
topic_clus <- maptpx::topics(dat, K=3, type="independent", tol=50,
signatures = signature_pos)
omega <- topic_clus$omega
#
levels <- unique(labs)
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(labs, levels = levels)
)
rownames(omega) <- annotation$sample_id
output_dir <- "../utilities/Lindo2016_wo_939/clus_3/"
topic_cols = c("red","blue","darkgoldenrod1","cyan","firebrick", "green",
"hotpink","burlywood","yellow","darkgray","deepskyblue","darkkhaki",
"brown4","darkorchid","magenta","yellow", "azure1","azure4")
structure_width = 5
structure_height = 8
structure.control <- list()
K=3
structure.control.default <- list(yaxis_label = "aRchaic pops",
order_sample = FALSE,
figure_title = paste0("  StructurePlot: K=", K,""),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 10,
axis_label_face = "bold"),
legend_title_size = 10,
legend_key_size = 0.7,
legend_text_size = 8)
structure.control <- modifyList(structure.control, structure.control.default)
plot.new()
grid.newpage()
do.call(StructureGGplot, append(list(omega= omega,
annotation = annotation,
palette = topic_cols),
structure.control))
ggplot2::ggsave(paste0(output_dir, "structure.png"), width = structure_width,
height = structure_height)
plot.new()
damageLogo_five(topic_clus$theta, save_plot=TRUE,
inflation_factor = c(2,1,2), output_dir = output_dir)
graphics.off()
topic_clus <- maptpx::topics(dat, K=2, type="independent", tol=50,
signatures = signature_pos)
omega <- topic_clus$omega
#
levels <- unique(labs)
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(labs, levels = levels)
)
rownames(omega) <- annotation$sample_id
output_dir <- "../utilities/Lindo2016_wo_939/clus_2/"
topic_cols = c("red","blue","darkgoldenrod1","cyan","firebrick", "green",
"hotpink","burlywood","yellow","darkgray","deepskyblue","darkkhaki",
"brown4","darkorchid","magenta","yellow", "azure1","azure4")
structure_width = 5
structure_height = 8
structure.control <- list()
K=2
structure.control.default <- list(yaxis_label = "aRchaic pops",
order_sample = FALSE,
figure_title = paste0("  StructurePlot: K=", K,""),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 10,
axis_label_face = "bold"),
legend_title_size = 10,
legend_key_size = 0.7,
legend_text_size = 8)
structure.control <- modifyList(structure.control, structure.control.default)
plot.new()
grid.newpage()
do.call(StructureGGplot, append(list(omega= omega,
annotation = annotation,
palette = topic_cols),
structure.control))
ggplot2::ggsave(paste0(output_dir, "structure.png"), width = structure_width,
height = structure_height)
plot.new()
damageLogo_five(topic_clus$theta, save_plot=TRUE,
inflation_factor = c(2,1,2), output_dir = output_dir)
graphics.off()
folders <- c("../data/Lindo2016moderns/")
labs <- c(rep("moderns", 25))
levels <- unique(labs)
clus_out <- aRchaic_cluster(folders = folders,
K = 4,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_4/",
save_plot = TRUE)
folders <- c("../data/Lindo2016moderns/")
labs <- c(rep("moderns", 25))
levels <- unique(labs)
clus_out <- aRchaic_cluster(folders = folders,
K = 4,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_4/",
save_plot = TRUE)
folders <- c("../data/Lindo2016moderns/")
list.files(folders, pattern = ".csv")
lind_metadata <- read.table("../utilities/Lindo_metadata.txt")
lindo_metadata <- read.table("../utilities/Lindo_metadata.txt")
lindo_metadata
list.files(folders)
labs <- lindo_metadata[,2]
levels <- unique(labs)
length(labs)
lindo_metadata <- read.table("../utilities/Lindo_metadata.txt")
folders <- c("../data/Lindo2016moderns/")
labs <- lindo_metadata[,2]
levels <- unique(labs)
clus_out <- aRchaic_cluster(folders = folders,
K = 4,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_4/",
save_plot = TRUE)
clus_out <- aRchaic_cluster(folders = folders,
K = 3,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_3/",
save_plot = TRUE)
clus_out <- aRchaic_cluster(folders = folders,
K = 2,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_2/",
save_plot = TRUE)
aRchaic_view (dir = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = TRUE)
aRchaic_view (dir = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
aRchaic_view (file = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
grid.newpage()
aRchaic_view (file = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
grid.newpage()
par(new=TRUE)
aRchaic_view (file = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
grid.newpage()
par(new=TRUE)
aRchaic_view (file = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
grid.newpage()
par(new=TRUE)
par(mar=c(1,1,1,1))
aRchaic_view (file = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
source('~/Documents/ancient-damage/R/../../aRchaic.site/R/damageLogo_5.R')
grid.newpage()
par(new=TRUE)
par(mar=c(1,1,1,1))
aRchaic_view (file = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
setwd("~/Documents/ancient-damage/R")
aRchaic_view (file = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
library(gridBase)
library(grid)
aRchaic_view (file = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
par(plt=gridPLT()) # start a 'graphics' plot
par(new=TRUE) #
par(plt=gridPLT()) # start a 'graphics' plot
par(new=TRUE) #
par(plt=gridPLT()) # start a 'graphics' plot
par(new=TRUE) #
par(mfrow=c(1,1))
par(plt=gridPLT()) # start a 'graphics' plot
par(new=TRUE) #
par("mar")
graphics.off()
dev.off()
par("mar")
par(plt=gridPLT())
par(mar = c(1,1,1,1))
par(plt=gridPLT())
plot.new()
par(oma=rep(1, 4), mfrow=c(1, 1), xpd=NA)
par(plt=gridPLT())
aRchaic_view (file = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
opar <- par(no.readonly=TRUE)
par(opar)
grid.newpage()
par(plt=gridPLT())
par(plt=gridPLT())
aRchaic_view (file = "../data/Skoglund/Ajv59.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20, 2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = FALSE)
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = TRUE)
library(ggplot2)
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = TRUE)
library(Logolas)
source("../../aRchaic.site/R/aggregate_signature_counts.R")
source("../../aRchaic.site/R/club_signature_counts.R")
source("../../aRchaic.site/R/aRchaic_view.R")
source("../../aRchaic.site/R/filter_signatures_only_location.R")
source("../../aRchaic.site/R/aRchaic_cluster.R")
source("../../aRchaic.site/R/aRchaic_pool.R")
source("../../aRchaic.site/R/damageLogo_5.R")
source("../../CountClust/R/StructureGGplot.R")
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = TRUE)
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = TRUE)
source('~/Documents/ancient-damage/R/../../aRchaic.site/R/damageLogo_5.R')
source('~/Documents/ancient-damage/R/../../aRchaic.site/R/damageLogo_5.R')
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = TRUE)
source('~/Documents/ancient-damage/R/../../aRchaic.site/R/damageLogo_5.R')
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL,
save_plot = TRUE)
source('~/Documents/ancient-damage/R/../../aRchaic.site/R/damageLogo_5.R')
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
source('~/Documents/aRchaic.site/R/aRchaic_view.R')
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,2)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,5)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
aRchaic_view (file = "../data/Lindo2016moderns/S001_all_chr.q30.csv",
breaks = c(-1, seq(1,20,5)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
aRchaic_view (file = "../data/Lindo2016moderns/S002_all_chr.q30.csv",
breaks = c(-1, seq(1,20,5)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
aRchaic_view (file = "../data/Lindo2016moderns/t028_all_chr.q30.csv",
breaks = c(-1, seq(1,20,5)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
aRchaic_view (file = "../data/Lindo2016moderns/t028_all_chr.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
aRchaic_view (file = "../data/Raghavan/BC23.hg19.flt.sort.rmdup.realign.md.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
source('~/Documents/ancient-damage/R/../../aRchaic.site/R/damageLogo_5.R')
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
lindo_metadata <- read.table("../utilities/Lindo_metadata.txt")
folders <- c("../data/Lindo2016moderns/")
labs <- lindo_metadata[,2]
levels <- unique(labs)
clus_out <- aRchaic_cluster(folders = folders,
K = 2,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_2/",
save_plot = TRUE)
source('~/Documents/aRchaic.site/R/aRchaic_cluster.R')
lindo_metadata <- read.table("../utilities/Lindo_metadata.txt")
folders <- c("../data/Lindo2016moderns/")
labs <- lindo_metadata[,2]
levels <- unique(labs)
clus_out <- aRchaic_cluster(folders = folders,
K = 2,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_2/",
save_plot = TRUE)
lindo_metadata <- read.table("../utilities/Lindo_metadata.txt")
folders <- c("../data/Lindo2016moderns/")
labs <- lindo_metadata[,2]
levels <- unique(labs)
clus_out <- aRchaic_cluster(folders = folders,
K = 2,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_2/")
source('~/Documents/aRchaic.site/R/aRchaic_cluster.R')
lindo_metadata <- read.table("../utilities/Lindo_metadata.txt")
folders <- c("../data/Lindo2016moderns/")
labs <- lindo_metadata[,2]
levels <- unique(labs)
clus_out <- aRchaic_cluster(folders = folders,
K = 2,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_2/")
source('~/Documents/ancient-damage/R/../../aRchaic.site/R/damageLogo_5.R')
source('~/Documents/aRchaic.site/R/aRchaic_cluster.R')
clus_out <- aRchaic_cluster(folders = folders,
K = 2,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_2/")
clus_out <- aRchaic_cluster(folders = folders,
K = 3,
labs = labs,
levels = levels,
tol = 10,
run_from = "plot",
output_dir = "../utilities/Lindo2016moderns/clus_3/")
aRchaic_view (file = "../data/Skoglund/Ajv52.hs37d5.fa.merged.q30.csv",
breaks = c(-1, seq(1,20,1)),
flanking_bases =1,
logo.control = list(),
title = "Skoglund aDNA",
output_dir = NULL)
